@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    color-scheme: light;
    /* Minimal scrollbar variables */
    --scrollbar-size: 10px;
    --scrollbar-thumb: #e0e4e1; /* slate-200 cedar-tinted */
    --scrollbar-thumb-hover: #c8cfcb; /* slate-300 cedar-tinted */
  }

  :root.dark {
    color-scheme: dark;
    --scrollbar-thumb: #313d35; /* slate-700 cedar-tinted */
    --scrollbar-thumb-hover: #1e2a22; /* slate-800 cedar-tinted */
  }

  html,
  body {
    height: 100%;
  }

  body {
    @apply bg-slate-50 text-slate-900 antialiased transition-colors duration-200 ease-in-out dark:bg-slate-950 dark:text-slate-100;
    -webkit-text-size-adjust: 100%;
    position: fixed;
    inset: 0;
    width: 100%;
    overflow: hidden;
    overscroll-behavior-y: contain;
  }

  #app {
    min-height: 100%;
    display: flex;
    flex-direction: column;
    overflow-x: hidden;
    overflow-y: auto;
    height: 100vh;
    height: 100dvh;
    min-height: 100vh;
    min-height: 100svh;
    overscroll-behavior-y: contain;
  }

  .app-shell {
    min-height: 100vh;
    min-height: 100svh;
    min-height: 100dvh;
  }

  /* Minimal scrollbar: show a slim thumb, no visible track */
  /* Firefox */
  * {
    scrollbar-width: thin; /* "auto" | "thin" */
    scrollbar-color: var(--scrollbar-thumb) transparent; /* thumb | track */
  }
  /* Chromium/WebKit */
  *::-webkit-scrollbar {
    width: var(--scrollbar-size);
    height: var(--scrollbar-size);
    background: transparent; /* hide track */
  }
  *::-webkit-scrollbar-thumb {
    background-color: var(--scrollbar-thumb);
    border-radius: 9999px;
    border: 2px solid transparent; /* keeps thumb subtle while slightly thicker */
    background-clip: content-box;
  }
  *::-webkit-scrollbar-thumb:hover {
    background-color: var(--scrollbar-thumb-hover);
  }
  *::-webkit-scrollbar-track {
    background: transparent; /* no track */
  }
  *::-webkit-scrollbar-corner {
    background: transparent;
  }
}

@media (max-width: 640px) {
  /* Hide MapLibre's +/- navigation/zoom controls on mobile only */
  .maplibregl-ctrl-top-right .maplibregl-ctrl-group {
    display: none !important;
  }

  /* Prevent iOS Safari zoom on input focus by ensuring minimum 16px font size */
  input[type="text"],
  input[type="search"],
  input[type="email"],
  input[type="tel"],
  input[type="number"],
  input[type="password"],
  input[type="url"],
  input[type="time"],
  textarea,
  select {
    font-size: max(16px, 1rem);
  }
}

/* Soften MapLibre attribution in both normal and compact modes. */
.maplibregl-ctrl.maplibregl-ctrl-attrib,
.maplibregl-ctrl-attrib.maplibregl-compact,
.maplibregl-ctrl-attrib.maplibregl-compact-show,
.maplibregl-ctrl-attrib-button {
  color: rgba(71, 85, 105, 0.9) !important;
  background-color: rgba(226, 232, 240, 0.72) !important;
  backdrop-filter: blur(2px);
}

.maplibregl-ctrl-attrib a,
.maplibregl-ctrl-attrib button,
.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button {
  color: rgba(71, 85, 105, 0.9) !important;
}

/* Dark mode attribution contrast: near-black pill with muted gray text. */
:root.dark .maplibregl-ctrl.maplibregl-ctrl-attrib,
:root.dark .maplibregl-ctrl-attrib.maplibregl-compact,
:root.dark .maplibregl-ctrl-attrib.maplibregl-compact-show,
:root.dark .maplibregl-ctrl-attrib-button {
  color: rgba(148, 163, 184, 0.92) !important;
  background-color: rgba(2, 6, 23, 0.84) !important;
}

:root.dark .maplibregl-ctrl-attrib a,
:root.dark .maplibregl-ctrl-attrib button,
:root.dark .maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button {
  color: rgba(148, 163, 184, 0.92) !important;
}

@layer components {
  /* Hide number input spinners */
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  input[type="number"] {
    -moz-appearance: textfield;
    appearance: textfield;
  }

  .divider {
    @apply h-4 w-px bg-slate-200 dark:bg-slate-700;
  }

  .no-scrollbar {
    scrollbar-width: none;
  }

  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }

  /* Brand-style native clear icon for primary search bars (WebKit). */
  .search-input-brand-cancel::-webkit-search-cancel-button {
    -webkit-appearance: none;
    appearance: none;
    width: 12px;
    height: 12px;
    cursor: pointer;
    opacity: 0.9;
    background-color: #7678b2; /* brand-600 */
    -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M4 4l8 8M12 4L4 12' stroke='black' stroke-width='1.7' stroke-linecap='round'/%3E%3C/svg%3E");
    mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M4 4l8 8M12 4L4 12' stroke='black' stroke-width='1.7' stroke-linecap='round'/%3E%3C/svg%3E");
    -webkit-mask-repeat: no-repeat;
    mask-repeat: no-repeat;
    -webkit-mask-position: center;
    mask-position: center;
    -webkit-mask-size: contain;
    mask-size: contain;
  }

  .search-input-brand-cancel::-webkit-search-cancel-button:hover {
    background-color: #5f619e; /* brand-700 */
  }

  .chip-fade-right {
    -webkit-mask-image: linear-gradient(90deg, #000 80%, transparent);
    mask-image: linear-gradient(90deg, #000 80%, transparent);
  }

  .pt-safe {
    padding-top: env(safe-area-inset-top, 0px);
  }

  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom, 0px);
  }

}
